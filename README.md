# 3x-ui-ufw-sync

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø–æ—Ä—Ç–æ–≤ **3x-ui** —Å UFW. –°–∫—Ä–∏–ø—Ç –¥–æ–±–∞–≤–ª—è–µ—Ç TCP-–ø–æ—Ä—Ç—ã –∞–∫—Ç–∏–≤–Ω—ã—Ö inbound-–æ–≤ –∏ —É–¥–∞–ª—è–µ—Ç –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ, —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è –¥–ª—è –ø—Ä–∞–≤–∏–ª.

## ‚ö° –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ TCP-–ø–æ—Ä—Ç–æ–≤ –∞–∫—Ç–∏–≤–Ω—ã—Ö inbound-–æ–≤ 3x-ui –≤ UFW.  
- –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –∏–ª–∏ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –ø—Ä–∞–≤–∏–ª.  
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –¥–ª—è –ø—Ä–∞–≤–∏–ª.  
- –í—ã–≤–æ–¥ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –∫–æ–Ω—Å–æ–ª—å.

## üì¶ –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã:  
- `curl` ‚Äî –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API 3x-ui.  
- `jq` ‚Äî –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ JSON –∏–∑ API.  
- `ufw` ‚Äî –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä–æ–º.

–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞ Ubuntu/Debian:
```bash
sudo apt update
sudo apt install curl jq ufw -y
```

## üíæ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∫—Ä–∏–ø—Ç–∞

1. –°–∫–∞—á–∞–π—Ç–µ —Å–∫—Ä–∏–ø—Ç:
```bash
sudo wget -O /usr/local/bin/3x-ui-ufw-sync.sh https://github.com/mahlenko/3x-ui-ufw-sync/raw/main/3x-ui-ufw-sync.sh
```

2. –°–¥–µ–ª–∞–π—Ç–µ –µ–≥–æ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º:
```bash
sudo chmod +x /usr/local/bin/3x-ui-ufw-sync.sh
```

3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ –Ω–∞—á–∞–ª–µ —Å–∫—Ä–∏–ø—Ç–∞:
```bash
PANEL_URL="http://127.0.0.1:60414/"    # –ø–æ–ª–Ω—ã–π –∞–¥—Ä–µ—Å –ø–∞–Ω–µ–ª–∏ 3x-ui —Å webBasePath
USERNAME="your_username"               # –ª–æ–≥–∏–Ω
PASSWORD="your_password"               # –ø–∞—Ä–æ–ª—å
COMMENT="3x-ui-inbound"                # –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –¥–ª—è –ø—Ä–∞–≤–∏–ª ufw (tag)
```

## ‚ñ∂Ô∏è –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

–ó–∞–ø—É—Å–∫ –≤—Ä—É—á–Ω—É—é:
```bash
sudo /usr/local/bin/3x-ui-ufw-sync.sh
```

–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:
```
=== –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø–æ—Ä—Ç–æ–≤ 3x-ui —Å ufw ===
[+] –î–æ–±–∞–≤–ª—è—é –ø—Ä–∞–≤–∏–ª–æ 47890/tcp
[-] –£–¥–∞–ª—è—é –ø—Ä–∞–≤–∏–ª–æ 47891/tcp (–Ω–µ—Ç –≤ inbound)
=== –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞ ===
```

## ‚è∞ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ cron

–ß—Ç–æ–±—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Ä—Ç—ã —Ä–µ–≥—É–ª—è—Ä–Ω–æ, –¥–æ–±–∞–≤—å—Ç–µ cron:
```bash
sudo crontab -e
```
–ò –¥–æ–±–∞–≤—å—Ç–µ —Å—Ç—Ä–æ–∫—É –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç:
```cron
*/5 * * * * /usr/local/bin/3x-ui-ufw-sync.sh
```
- –°–∫—Ä–∏–ø—Ç –±—É–¥–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç.

–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å:
```cron
*/5 * * * * /usr/local/bin/3x-ui-ufw-sync.sh >> /var/log/3x-ui-ufw-sync.log 2>&1
``` 
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–¥—ë—Ç –≤ `/var/log/3x-ui-ufw-sync.log`.

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License ‚Äî —Å–≤–æ–±–æ–¥–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ, –∏–∑–º–µ–Ω—è–π—Ç–µ –∏ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–π—Ç–µ —Å–∫—Ä–∏–ø—Ç.
